# Encrypt Now Backend

Этот проект реализует бэкенд для безопасного мессенджера со сквозным шифрованием. Он построен с использованием FastAPI и использует PostgreSQL для хранения данных.

## Основная функциональность

- **Сквозное шифрование:** Фронтенд обрабатывает все операции шифрования и дешифрования. Пользователи генерируют сид-фразу, из которой затем получаются приватный и публичный ключи.
- **Структура зашифрованного сообщения:** Внутри зашифрованного пакета содержится отметка времени отправления. Она используется клиентом-получателем после расшифровки для дополнительной защиты от replay-атак.
- **Защита от Replay-атак на сервере:** Так как сервер не имеет доступа к содержимому пакетов, он реализует защиту иначе. Бэкенд хранит хеши последних 50 полученных сообщений для каждого получателя. Если приходит пакет, хеш которого совпадает с одним из сохраненных, он отклоняется как дубликат.
- **Безопасная передача данных:** Фронтенд отправляет POST-запросы, содержащие зашифрованные данные сообщений.
- **Идентификация получателя:** Публичный ключ получателя включается в заголовок запроса, выступая в качестве его уникального идентификатора.
- **Идентификация отправителя:** Публичный ключ отправителя включается в заголовок запроса, выступая в качестве его уникального идентификатора.
- **Хранение сообщений:** Бэкенд получает зашифрованные пакеты и сохраняет их в базе данных PostgreSQL, связывая сообщение с отправителем и получателем через их уникальные идентификаторы.
- **Доставка через вебхук:** Если клиент, связанный с указанным публичным ключом, ожидает вебхук, бэкенд перенаправит ему сохраненный зашифрованный пакет.

Этот бэкенд выступает в роли безопасного посредника, облегчая зашифрованную связь без доступа к незашифрованному содержимому сообщений.

## Запуск и настройка

### С использованием Docker (Рекомендуемый способ)

1.  **Установите Docker и Docker Compose.**
    *   Инструкции по установке вы найдете на официальных сайтах [Docker](https://docs.docker.com/get-docker/) и [Docker Compose](https://docs.docker.com/compose/install/).

2.  **Создайте файл `.env`**
    *   Скопируйте файл `.env.example` и переименуйте его в `.env`.
    ```bash
    cp .env.example .env
    ```
    *   При необходимости измените значения переменных окружения в файле `.env`.

3.  **Запустите приложение**
    *   Выполните следующую команду в корневой директории проекта:
    ```bash
    docker-compose up -d --build
    ```
    *   Приложение будет доступно по адресу `http://localhost:8000`.
